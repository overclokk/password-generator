<!DOCTYPE html>
<!--Copyright 2014 Enea Overclokk-->
<!--This program is free software: you can redistribute it and/or modify
	it under the terms of the GNU General Public License as published by
	the Free Software Foundation, either version 3 of the License, or
	(at your option) any later version.
	This program is distributed in the hope that it will be useful,
	but WITHOUT ANY WARRANTY; without even the implied warranty of
	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
	GNU General Public License for more details.
	You should have received a copy of the GNU General Public License
	along with this program. If not, see <http://www.gnu.org/licenses/>.-->
<!--For more information and contact read the README.md-->
<!-- Icon made by <a href="http://www.freepik.com" title="Freepik">Freepik</a> from <a href="http://www.flaticon.com" title="Flaticon">www.flaticon.com</a> is licensed under <a href="http://creativecommons.org/licenses/by/3.0/" title="Creative Commons BY 3.0">CC BY 3.0</a> -->
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Password generator and validator</title>
        <meta name="description" content="Generate your strenght password with this tool">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
		<link rel="stylesheet" href="css/bootstrap.min.css" type="text/css" charset="utf-8" />

        <style>.form-group{margin-bottom:10px;}</style>
    </head>
    <body>
		<header>
			<nav class="navbar navbar-inverse" role="navigation">
				<div class="container">
					<div class="container-fluid">
						<!-- Brand and toggle get grouped for better mobile display -->
						<div class="navbar-header">
							<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
								<span class="sr-only">Toggle navigation</span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
							</button>
							<span class="navbar-brand">Password Generator</span>
						</div>

						<!-- Collect the nav links, forms, and other content for toggling -->
						<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
							<ul class="nav navbar-nav">
								<li><a href="index.html">Generator</a></li>
								<li><a href="faq.html">Faq</a></li>
							</ul>
						</div><!-- /.navbar-collapse -->

					</div><!-- /.container-fluid -->

				</div>
			</nav>
		</header>
		<div class="container">
			<div class="row">
				<div class="col-sm-6 col-sm-push-4">
					<form  role="form" class="form-horizontal" id="create_password_form" novalidate="novalidate" name="form">
						<div class="form-group" id="password_group">
							<label for="password_length" class="col-sm-4 col-xs-8 control-label">Password lenght: <br><small>(At least 8)</small></label>
							<div class="col-sm-2 col-xs-4" id="prova">
								<input type="text" value="8" class="text valid form-control" name="password_length" id="password_length">
							</div>
						</div>
						<div class="form-group">
							<label for="extra_caracters" class="col-sm-4 col-xs-8 control-label">Extra characters: <br><small>(optional)</small></label>
							<div class="col-sm-2 col-xs-4">
								<input type="text" value="" class="text valid form-control" name="extra_caracters" id="extra_caracters">
							</div>
						</div>
						<div class="form-group">
							<label for="include_letters" class="col-sm-4 col-xs-8 control-label">Lowercase (a-z):</label>
							<div class="col-sm-2 col-xs-2">
								<input type="checkbox" class="check" id="include_letters">
							</div>
						</div>
						<div class="form-group">
							<label for="include_mixedcase" class="col-sm-4 col-xs-8 control-label">Uppercase (A-Z):</label>
								<div class="col-sm-2 col-xs-2">
									<input type="checkbox" checked="checked" class="check" id="include_upper_letters">
								</div>
						</div>
						<div class="form-group">
							<label for="include_numbers" class="col-sm-4 col-xs-8 control-label">Numbers (0-9):</label>
								<div class="col-sm-2 col-xs-2">
									<input type="checkbox" checked="checked" class="check" id="include_numbers">
								</div>
						</div>
						<div class="form-group">
							<label for="include_punctuation" class="col-sm-4 col-xs-8 control-label">Special characters:</label>
								<div class="col-sm-2 col-xs-2">
									<input type="checkbox" class="check" id="include_punctuation">
								</div>
						</div>
						<div class="form-group">
							<label for="include_punctuation" class="col-sm-4 col-xs-4 control-label text-center">Your password:</label>
							<div class="col-sm-4 col-xs-8">
								<textarea class="form-control" rows="1" name="password" id="getPassword"></textarea>
							</div>
						</div>

						<div class="progress">
							<div class="progress-bar progress-bar-danger progress-bar-striped active" id="getPassword_bar">
								<span id="getPassword_text"></span>
							</div>
						</div>

						<div class="text-center">
							<button type="button" class="btn btn-warning" id="create_pass">Crea password</button>
							<button type="button" class="btn btn-xs btn-default" id="reset_fields">Reset</button>
						</div>
					</form>
				</div>
			</div>
		</div>
        
		<script src="js/jquery.min.js"></script>
		<script src="js/bootstrap.min.js"></script>

		<script>
			$(document).ready(function() {

				var extraCaracters = $( "#extra_caracters" );
				var inputLowerLetters = $( "#include_letters" );
				var inputUpperLetters = $( "#include_upper_letters" );
				var inputNumbers = $( "#include_numbers" );
				var inputPunctuation = $( "#include_punctuation" );		

				function verifyInput(){
				     // If is not selected lower and upper and numbers
				     if (!inputLowerLetters[0].checked && !inputUpperLetters[0].checked && !inputNumbers[0].checked && !inputPunctuation[0].checked){

				          alert('You need to choose the type of characters you want in your password');
				          return 0;
				     }

				     // If is not set password leght 
				     if(document.forms[0].elements[0].value==""){

				          alert('You must enter the desired length for your password, insert at least 8 characters for get secure password');
				          return 0;
				     }
				}


				function getRandomNum(lbound, ubound){

				     return (Math.floor(Math.random() * (ubound - lbound)) + lbound);
				}

				function getRandomChar(extra, lower, upper, number, punctuation){

					var lowerLetters = 'abcdefghijklmnopqrstuvwxyz';
					var upperLetters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
					var numbers = '0123456789';
					var punctuations = ':;><!"£$%&/()=?^*°#_-@+[]{}|,.§ç';

					var charSet = extra;

					if (lower == true) charSet += lowerLetters;
					if (upper == true) charSet += upperLetters;
					if (number == true) charSet += numbers;
					if (punctuation == true) charSet += punctuations;

					return charSet.charAt( getRandomNum( 0, charSet.length ) );
				}

				function getPassword(length, extra, lower, upper, number, punctuation){

				     var pass = "";
				     length++;

				     // if (length > 0) pass = pass + getRandomChar(extraChars, firstNumber, firstAlpha, firstOther);

				     for (var idx = 1; idx < length; ++idx){

				          pass = pass + getRandomChar(extra, lower, upper, number, punctuation);
				     }
				     return pass;
				}				

				// Password strength meter v1.0
				// Matthew R. Miller - 2007
				// www.codeandcoffee.com
				// Based off of code from  http://www.intelligent-web.co.uk

				// Settings
				// -- Toggle to true or false, if you want to change what is checked in the password
				var bCheckNumbers = true;
				var bCheckUpperCase = true;
				var bCheckLowerCase = true;
				var bCheckPunctuation = true;
				var nPasswordLifetime = 365;

				// Check password
				function checkPassword(strPassword){

					// Reset combination count
					nCombinations = 0;
					
					// Check numbers
					if (bCheckNumbers){

						strCheck = "0123456789";
						if (doesContain(strPassword, strCheck) > 0){ 

							nCombinations += strCheck.length; 
						}
					}
					
					// Check upper case
					if (bCheckUpperCase){

						strCheck = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
						if (doesContain(strPassword, strCheck) > 0){

							nCombinations += strCheck.length; 
						}
					}
					
					// Check lower case
					if (bCheckLowerCase){

						strCheck = "abcdefghijklmnopqrstuvwxyz";
						if (doesContain(strPassword, strCheck) > 0){

							nCombinations += strCheck.length; 
						}
					}
					
					// Check punctuation
					if (bCheckPunctuation){

						strCheck = ";:-_=+\|//?^&!.@$£#*()%~<>{}[]";
						if (doesContain(strPassword, strCheck) > 0){

							nCombinations += strCheck.length; 
						}
					}
					
					// Calculate
					// -- 500 tries per second => minutes 
					var nDays = ((Math.pow(nCombinations, strPassword.length) / 500) / 2) / 86400;

					// Number of days out of password lifetime setting
					var nPerc = nDays / nPasswordLifetime;
					
					return nPerc;
				}

				// Runs password through check and then updates GUI 
				function runPassword(strPassword, strFieldID){

					// Check password
					nPerc = checkPassword(strPassword);
					
					 // Get controls
					 var ctlBar = document.getElementById(strFieldID + "_bar"); 
					 var ctlText = document.getElementById(strFieldID + "_text");
					 if (!ctlBar || !ctlText)
					 	return;

				    	// Set new width
				    	var nRound = Math.round(nPerc * 100);
				    	if (nRound < (strPassword.length * 5)){

				    		nRound += strPassword.length * 5; 
				    	}
				    	if (nRound > 100) nRound = 100;

				    	// Lenght of bar
				    	ctlBar.style.width = nRound + "%";

				 	// Color and text
				 	if (nRound > 90){

				 		strText = "Very Secure";
				 		strColor = "#3bce08";
				 	} else if (nRound > 66){

				 		strText = "Secure";
				 		strColor = "orange";
				 	} else if (nRound > 34){

				 		strText = "Mediocre";
				 		strColor = "#ffd801";
				 	} else {

				 		strText = "Insecure";
				 		strColor = "red";
				 	}
				 	ctlBar.style.backgroundColor = strColor;
				 	ctlText.innerHTML = "<span id='textBar' style='color: white;'>" + nRound + "% " + strText + "</span>";
				 }
				 
				// Checks a string for a list of characters
				function doesContain(strPassword, strCheck){

					nCount = 0; 

					for (i = 0; i < strPassword.length; i++){

						if (strCheck.indexOf(strPassword.charAt(i)) > -1){ 

							nCount++; 
						} 
					} 

					return nCount; 
				}

				// Check if the length for password is good enough
				function checkLength (length) {

					if ( length > 7 ) {

						$('#password_group').removeClass().addClass('form-group has-success');

					} else if ( length > 5 ) {

						$('#password_group').removeClass().addClass('form-group has-warning');

					} else{

						$('#password_group').removeClass().addClass('form-group has-error');

					};
				}

				var password = $('#password_length');
				checkLength( password.val() );

				password.keyup( function() {

					var passwordVal = password.val();

					//Check if password length include number.
					if ( !( passwordVal.match(/\d/) ) && passwordVal !== '' ) {
					     alert("Password length must include number.");
					}

					checkLength( passwordVal );

				});


				$('#create_pass').click( function(){
					verifyInput();

					var password = $('#password_length');

					var length = password.val();
					var extra = extraCaracters.val();
					var lower = inputLowerLetters[0].checked;
					var upper = inputUpperLetters[0].checked;
					var number = inputNumbers[0].checked;
					var punctuation = inputPunctuation[0].checked;

					var pass = getPassword(length, extra, lower, upper, number, punctuation);

					$('#getPassword').html(pass);

					runPassword(pass, 'getPassword');

				});

				// Reset text area
				$('#reset_fields').click( function(){
					// Remove password from textarea
					$('#getPassword').html('');
					// Set 0% width of password bar
					$('#getPassword_bar').css('width', '0%');
					// Remove text from text bar
					$('#textBar').remove();
					// Remove class from password group
					$('#password_group').removeClass().addClass('form-group');
					// Remove length value
					$('#password_length').val('');
					// Remove extra characters value
					$('#extra_caracters').val('');

					var passwordVal = password.val();
					checkLength( passwordVal );
				});


			});

		</script>

        <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
        <script>
            (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
            function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
            e=o.createElement(i);r=o.getElementsByTagName(i)[0];
            e.src='//www.google-analytics.com/analytics.js';
            r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
            ga('create','UA-XXXXX-X');ga('send','pageview');
        </script>
    </body>
</html>